Algorytm KNP jest podobny do algorytmu MP, różni się sposobem wypełnienia tablicy $P$ (oznaczymy jako $P`$)

Tablicę $P`$ definiujemy jako
- dla $i<|wzorzec|$ : $P`[i]$ to długość najdłuższego prefikso-sufiksu słowa wzorzec jakiego że $wzorze